!function(t,e){var n={left:0,top:0,middle:.5,center:.5,right:1,bottom:1},r=/^\d+\s?px$/,a=/^\d+\s?%$/,o=t(window),i=t(document),s=[0,0],l=function(){var t=!1,e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(function(){t()},25)};function n(){var n,r=[];function a(){}function o(){var a=r.slice(0),o=a.length,i=-1;for(t&&console.log("timer frame()",o);++i<o;)a[i].call(this);e(n)}function i(){t&&console.log("timer start()"),this.start=a,this.stop=s,e(n=o)}function s(){t&&console.log("timer stop()"),this.start=i,this.stop=a,n=a}this.callbacks=r,this.start=i,this.stop=s}return n.prototype={add:function(e){for(var n=this.callbacks,r=n.length;r--;)if(n[r]===e)return;this.callbacks.push(e),t&&console.log("timer add()",this.callbacks.length)},remove:function(e){for(var n=this.callbacks,r=n.length;r--;)n[r]===e&&n.splice(r,1);t&&console.log("timer remove()",this.callbacks.length),0===n.length&&this.stop()}},n}();function u(t){return a.exec(t)?parseFloat(t)/100:t}function f(t){var e,n,r={"mouseenter.parallax":function(){i.timer.add(u)},"mouseleave.parallax":function(t){i.timer.remove(u),i.pointer=c([t.pageX,t.pageY],[!0,!0],n,e)}},a={"resize.parallax":f},i={elem:t,events:r,winEvents:a,timer:new l};function u(){i.pointer=c(s,[!0,!0],n,e)}function f(){var r;e=[(r=t).width(),r.height()],n=function(t){var e=t.offset()||{left:0,top:0},n="none"===t.css("borderLeftStyle")?0:parseInt(t.css("borderLeftWidth"),10),r="none"===t.css("borderTopStyle")?0:parseInt(t.css("borderTopWidth"),10),a=parseInt(t.css("paddingLeft"),10),o=parseInt(t.css("paddingTop"),10);return[e.left+n+a,e.top+r+o]}(t),i.threshold=function(t){return[1/t[0],1/t[1]]}(e)}return o.on(a),t.on(r),f(),i}function c(t,e,n,r){for(var a=[],o=2;o--;)a[o]=(t[o]-n[o])/r[o],a[o]=a[o]<0?0:a[o]>1?1:a[o];return a}function p(t,e,n,r,a,o,i){var s,l;if((!a[0]||Math.abs(t[0]-e[0])<n[0])&&(!a[1]||Math.abs(t[1]-e[1])<n[1]))return o&&o(),i(t);for(s=[],l=2;l--;)a[l]&&(s[l]=t[l]+r*(e[l]-t[l]));return i(s)}function h(t,e,n,r,a,o,i){if(t[0]!==e[0]||t[1]!==e[1])return i(t)}function m(t,e,n){e.elem.off(n),e.layers=e.layers.not(t),0===e.layers.length&&function(t,e,n){t.off(e).removeData("parallax_port"),o.off(n)}(e.elem,e.events,e.winEvents)}t.fn.parallax=function(a){var o=t.extend({},t.fn.parallax.options,a),i=arguments,s=function(t,e,n){var r=t.data(e);return r||(r=n?n(t):{},t.data(e,r)),r}(o.mouseport instanceof t?o.mouseport:t(o.mouseport),"parallax_port",f),l=s.timer;return this.each(function(a){var f,c,m=t(this),d=i[a+1]?t.extend({},o,i[a+1]):o,v=d.decay,x=function(t,e,n){return[e||t.outerWidth(),n||t.outerHeight()]}(m,d.width,d.height),g=function(t,r){for(var a=[t,r],o=2,i=[];o--;)i[o]="string"==typeof a[o]?a[o]===e?1:n[i[o]]||u(i[o]):a[o];return i}(d.xorigin,d.yorigin),w=(f=d.xparallax,c=d.yparallax,[r.test(f),r.test(c)]),y=function(t,e,n){for(var r=[t,e],a=2,o=[];a--;)o[a]=n[a]?parseInt(r[a],10):o[a]=!0===r[a]?1:u(r[a]);return o}(d.xparallax,d.yparallax,w),b=function(t,e,n,r){for(var a=2,o=[];a--;)o[a]=e[a]?n[a]*(r[a]-t[a]):t[a]?n[a]*(1-t[a]):0;return o}(y,w,g,x),k=function(t,e){for(var n=2,r=[];n--;)t[n]&&(r[n]=100*e[n]+"%");return r}(w,g),F=function(t,e,n,r,a){for(var o=t.offsetParent(),i=t.position(),s=[],l=[],u=2;u--;)s[u]=n[u]?0:i[0===u?"left":"top"]/(o[0===u?"outerWidth":"outerHeight"]()-a[u]),l[u]=(s[u]-r[u])/e[u];return l}(m,y,w,b,x),T=p,q=z,A={"mouseenter.parallax":function(t){T=p,q=z,l.add(L),l.start()},"mouseleave.parallax":function(t){T=p,q=R}};function I(t){var e=function(t,e,n,r,a,o){for(var i,s,l=[],u=2,f={};u--;)t[u]&&(l[u]=t[u]*o[u]+n[u],e[u]?(i=a[u],s=-1*l[u]):(i=100*l[u]+"%",s=l[u]*r[u]*-1),0===u?(f.left=i,f.marginLeft=s):(f.top=i,f.marginTop=s));return f}(y,w,b,x,k,t);m.css(e),F=t}function L(){T(s.pointer,F,s.threshold,v,y,q,I)}function z(){T=h}function R(){l.remove(L)}t.data(this,"parallax")&&m.unparallax(),t.data(this,"parallax",{port:s,events:A,parallax:y}),s.elem.on(A),s.layers=s.layers?s.layers.add(this):t(this)})},t.fn.unparallax=function(e){return this.each(function(){var n,r,a=t.data(this,"parallax");a&&(t.removeData(this,"parallax"),m(this,a.port,a.events),e&&(n=a.parallax,r={},n[0]&&(r.left="",r.marginLeft=""),n[1]&&(r.top="",r.marginTop=""),elem.css(r)))})},t.fn.parallax.options={mouseport:"body",xparallax:!0,yparallax:!0,xorigin:.5,yorigin:.5,decay:.66,frameDuration:30,freezeClass:"freeze"},i.on("mousemove.parallax",function(t){s=[t.pageX,t.pageY]})}(jQuery);
